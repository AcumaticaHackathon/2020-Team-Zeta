DROP VIEW IF EXISTS CSGenericFormResults
GO
CREATE VIEW CSGenericFormResults AS
 SELECT a.CompanyID, a.UserResponseID, c.Description FormDescription, 
	c.UserDefDataID, c.UserDefDataCD,
	MAX(CASE b.SequenceNo WHEN 1 THEN b.DataElementName ELSE '' END) AS Field1,
	MAX(CASE b.SequenceNo WHEN 1 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field1Value,
	MAX(CASE b.SequenceNo WHEN 2 THEN b.DataElementName ELSE '' END) AS Field2,
	MAX(CASE b.SequenceNo WHEN 2 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field2Value,
	MAX(CASE b.SequenceNo WHEN 3 THEN b.DataElementName ELSE '' END) AS Field3,
	MAX(CASE b.SequenceNo WHEN 3 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field3Value,
	MAX(CASE b.SequenceNo WHEN 4 THEN b.DataElementName ELSE '' END) AS Field4,
	MAX(CASE b.SequenceNo WHEN 4 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field4Value,
	MAX(CASE b.SequenceNo WHEN 5 THEN b.DataElementName ELSE '' END) AS Field5,
	MAX(CASE b.SequenceNo WHEN 5 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field5Value,
	MAX(CASE b.SequenceNo WHEN 6 THEN b.DataElementName ELSE '' END) AS Field6,
	MAX(CASE b.SequenceNo WHEN 6 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field6Value,
	MAX(CASE b.SequenceNo WHEN 7 THEN b.DataElementName ELSE '' END) AS Field7,
	MAX(CASE b.SequenceNo WHEN 7 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field7Value,
	MAX(CASE b.SequenceNo WHEN 8 THEN b.DataElementName ELSE '' END) AS Field8,
	MAX(CASE b.SequenceNo WHEN 8 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field8Value,
	MAX(CASE b.SequenceNo WHEN 9 THEN b.DataElementName ELSE '' END) AS Field9,
	MAX(CASE b.SequenceNo WHEN 9 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field9Value,
	MAX(CASE b.SequenceNo WHEN 10 THEN b.DataElementName ELSE '' END) AS Field10,
	MAX(CASE b.SequenceNo WHEN 10 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field10Value,
	MAX(CASE b.SequenceNo WHEN 11 THEN b.DataElementName ELSE '' END) AS Field11,
	MAX(CASE b.SequenceNo WHEN 11 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field11Value,
	MAX(CASE b.SequenceNo WHEN 12 THEN b.DataElementName ELSE '' END) AS Field12,
	MAX(CASE b.SequenceNo WHEN 12 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field12Value,
	MAX(CASE b.SequenceNo WHEN 13 THEN b.DataElementName ELSE '' END) AS Field13,
	MAX(CASE b.SequenceNo WHEN 13 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field13Value,
	MAX(CASE b.SequenceNo WHEN 14 THEN b.DataElementName ELSE '' END) AS Field14,
	MAX(CASE b.SequenceNo WHEN 14 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field14Value,
	MAX(CASE b.SequenceNo WHEN 15 THEN b.DataElementName ELSE '' END) AS Field15,
	MAX(CASE b.SequenceNo WHEN 15 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field15Value,
	MAX(CASE b.SequenceNo WHEN 16 THEN b.DataElementName ELSE '' END) AS Field16,
	MAX(CASE b.SequenceNo WHEN 16 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field16Value,
	MAX(CASE b.SequenceNo WHEN 17 THEN b.DataElementName ELSE '' END) AS Field17,
	MAX(CASE b.SequenceNo WHEN 17 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field17Value,
	MAX(CASE b.SequenceNo WHEN 18 THEN b.DataElementName ELSE '' END) AS Field18,
	MAX(CASE b.SequenceNo WHEN 18 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field18Value,
	MAX(CASE b.SequenceNo WHEN 19 THEN b.DataElementName ELSE '' END) AS Field19,
	MAX(CASE b.SequenceNo WHEN 19 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field19Value,
	MAX(CASE b.SequenceNo WHEN 20 THEN b.DataElementName ELSE '' END) AS Field20,
	MAX(CASE b.SequenceNo WHEN 20 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field20Value,
	MAX(CASE b.SequenceNo WHEN 21 THEN b.DataElementName ELSE '' END) AS Field21,
	MAX(CASE b.SequenceNo WHEN 21 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field21Value,
	MAX(CASE b.SequenceNo WHEN 22 THEN b.DataElementName ELSE '' END) AS Field22,
	MAX(CASE b.SequenceNo WHEN 22 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field22Value,
	MAX(CASE b.SequenceNo WHEN 23 THEN b.DataElementName ELSE '' END) AS Field23,
	MAX(CASE b.SequenceNo WHEN 23 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field23Value,
	MAX(CASE b.SequenceNo WHEN 24 THEN b.DataElementName ELSE '' END) AS Field24,
	MAX(CASE b.SequenceNo WHEN 24 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field24Value,
	MAX(CASE b.SequenceNo WHEN 25 THEN b.DataElementName ELSE '' END) AS Field25,
	MAX(CASE b.SequenceNo WHEN 25 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field25Value,
	MAX(CASE b.SequenceNo WHEN 26 THEN b.DataElementName ELSE '' END) AS Field26,
	MAX(CASE b.SequenceNo WHEN 26 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field26Value,
	MAX(CASE b.SequenceNo WHEN 27 THEN b.DataElementName ELSE '' END) AS Field27,
	MAX(CASE b.SequenceNo WHEN 27 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field27Value,
	MAX(CASE b.SequenceNo WHEN 28 THEN b.DataElementName ELSE '' END) AS Field28,
	MAX(CASE b.SequenceNo WHEN 28 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field28Value,
	MAX(CASE b.SequenceNo WHEN 29 THEN b.DataElementName ELSE '' END) AS Field29,
	MAX(CASE b.SequenceNo WHEN 29 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field29Value,
	MAX(CASE b.SequenceNo WHEN 30 THEN b.DataElementName ELSE '' END) AS Field30,
	MAX(CASE b.SequenceNo WHEN 30 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field30Value,
	MAX(CASE b.SequenceNo WHEN 31 THEN b.DataElementName ELSE '' END) AS Field31,
	MAX(CASE b.SequenceNo WHEN 31 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field31Value,
	MAX(CASE b.SequenceNo WHEN 32 THEN b.DataElementName ELSE '' END) AS Field32,
	MAX(CASE b.SequenceNo WHEN 32 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field32Value,
	MAX(CASE b.SequenceNo WHEN 33 THEN b.DataElementName ELSE '' END) AS Field33,
	MAX(CASE b.SequenceNo WHEN 33 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field33Value,
	MAX(CASE b.SequenceNo WHEN 34 THEN b.DataElementName ELSE '' END) AS Field34,
	MAX(CASE b.SequenceNo WHEN 34 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field34Value,
	MAX(CASE b.SequenceNo WHEN 35 THEN b.DataElementName ELSE '' END) AS Field35,
	MAX(CASE b.SequenceNo WHEN 35 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field35Value,
	MAX(CASE b.SequenceNo WHEN 36 THEN b.DataElementName ELSE '' END) AS Field36,
	MAX(CASE b.SequenceNo WHEN 36 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field36Value,
	MAX(CASE b.SequenceNo WHEN 37 THEN b.DataElementName ELSE '' END) AS Field37,
	MAX(CASE b.SequenceNo WHEN 37 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field37Value,
	MAX(CASE b.SequenceNo WHEN 38 THEN b.DataElementName ELSE '' END) AS Field38,
	MAX(CASE b.SequenceNo WHEN 38 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field38Value,
	MAX(CASE b.SequenceNo WHEN 39 THEN b.DataElementName ELSE '' END) AS Field39,
	MAX(CASE b.SequenceNo WHEN 39 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field39Value,
	MAX(CASE b.SequenceNo WHEN 40 THEN b.DataElementName ELSE '' END) AS Field40,
	MAX(CASE b.SequenceNo WHEN 40 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field40Value,
	MAX(CASE b.SequenceNo WHEN 41 THEN b.DataElementName ELSE '' END) AS Field41,
	MAX(CASE b.SequenceNo WHEN 41 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field41Value,
	MAX(CASE b.SequenceNo WHEN 42 THEN b.DataElementName ELSE '' END) AS Field42,
	MAX(CASE b.SequenceNo WHEN 42 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field42Value,
	MAX(CASE b.SequenceNo WHEN 43 THEN b.DataElementName ELSE '' END) AS Field43,
	MAX(CASE b.SequenceNo WHEN 43 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field43Value,
	MAX(CASE b.SequenceNo WHEN 44 THEN b.DataElementName ELSE '' END) AS Field44,
	MAX(CASE b.SequenceNo WHEN 44 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field44Value,
	MAX(CASE b.SequenceNo WHEN 45 THEN b.DataElementName ELSE '' END) AS Field45,
	MAX(CASE b.SequenceNo WHEN 45 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field45Value,
	MAX(CASE b.SequenceNo WHEN 46 THEN b.DataElementName ELSE '' END) AS Field46,
	MAX(CASE b.SequenceNo WHEN 46 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field46Value,
	MAX(CASE b.SequenceNo WHEN 47 THEN b.DataElementName ELSE '' END) AS Field47,
	MAX(CASE b.SequenceNo WHEN 47 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field47Value,
	MAX(CASE b.SequenceNo WHEN 48 THEN b.DataElementName ELSE '' END) AS Field48,
	MAX(CASE b.SequenceNo WHEN 48 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field48Value,
	MAX(CASE b.SequenceNo WHEN 49 THEN b.DataElementName ELSE '' END) AS Field49,
	MAX(CASE b.SequenceNo WHEN 49 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field49Value,
	MAX(CASE b.SequenceNo WHEN 50 THEN b.DataElementName ELSE '' END) AS Field50,
	MAX(CASE b.SequenceNo WHEN 50 THEN CONVERT(nvarchar(256),a.Value) ELSE '' END) AS Field50Value
FROM CSUserDefDataAnswers a
	JOIN CSUserDefDataDetail b ON a.CompanyID = b.CompanyID and a.UserDefDataID = b.UserDefDataID and a.UserDefDataLineID = b.UserDefDataLineID
	JOIN CSUserDefDataHeader c ON b.CompanyID = c.CompanyID and b.UserDefDataID = c.UserDefDataID
GROUP BY a.CompanyID, a.UserResponseID, c.UserDefDataCD, c.Description, c.UserDefDataID,	c.UserDefDataCD
GO